# 1. Mandatory events block
# Nginx refuses to start without this, even if it's empty.
events {}

# 2. The http block
# All web server configuration MUST live inside here.
http {
    # Include standard mime types (css, js, html, etc.)
    # Without this, your styles/scripts might not load correctly.
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    # YOUR ORIGINAL SERVER CONFIGURATION STARTS HERE
    server {
        listen 80;
        
        # 1. Serve the React App
        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;
            # Essential for React Router: redirect 404s to index.html
            try_files $uri $uri/ /index.html;
        }

        # 2. The Smoke Test Endpoint (AC4)
        location /healthz {
            access_log off;
            add_header 'Content-Type' 'application/json';
            return 200 '{"status":"UP", "version":"1.0.0"}';
        }

        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
    }
}